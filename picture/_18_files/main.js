/*! Copyright © 2011 - 2022 miHoYo. All Rights Reserved */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.miHoYoAnalysis=t():e.miHoYoAnalysis=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){var o,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(a){if(void 0===(i="function"==typeof(o=a)?o.call(t,n,t,e):o)||(e.exports=i),!0,e.exports=a(),!!0){var r=window.Cookies,s=window.Cookies=a();s.noConflict=function(){return window.Cookies=r,s}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function i(){}function a(t,n,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},i.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var r=JSON.stringify(n);/^[\{\[]/.test(r)&&(n=r)}catch(e){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in a)a[u]&&(s+="; "+u,!0!==a[u]&&(s+="="+a[u].split(";")[0]));return document.cookie=t+"="+n+s}}function r(e,n){if("undefined"!=typeof document){for(var i={},a=document.cookie?document.cookie.split("; "):[],r=0;r<a.length;r++){var s=a[r].split("="),u=s.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var d=t(s[0]);if(u=(o.read||o)(u,d)||t(u),n)try{u=JSON.parse(u)}catch(e){}if(i[d]=u,e===d)break}catch(e){}}return e?i[e]:i}}return i.set=a,i.get=function(e){return r(e,!1)},i.getJSON=function(e){return r(e,!0)},i.remove=function(t,n){a(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=u(n(2)),r=u(n(0)),s=n(3);function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app_id="",this.data_belong="",this.game_uid="",this.game_region="",this.needUid=!1,this.hasUpdateUid=!1,this.uuid=a.default.getUuid()||"",this.pvParams={eventCategory:"page",eventAction:"view",eventLabel:"",eventValue:""},this.pagename=void 0,this.pageurl=void 0,this.type="tool",this.bbsApp=void 0,this.device_id="",this.pageExtrainfo=void 0,this.userExtrainfo=void 0,this.eventExtrainfo=void 0,this.apis={production:"https://log-upload.mihoyo.com/h5/upload","production.sea":"https://log-upload-os.hoyoverse.com/h5/upload",test:"https://devlog-upload.mihoyo.com/h5/upload","test.sea":"https://devlog-upload-os.hoyoverse.com/h5/upload",development:"https://devlog-upload.mihoyo.com/h5/upload"},this.eventList=[],this.environment=this.getEnv(),this.isHostSea=this.getIsSea(),this.sessionIdCookieKey="_MIA_SESSION_ID",this.sessionStepCookieKey="_MIA_SESSION_STEP"}return i(e,[{key:"getIsSea",value:function(){for(var e=window.location.host,t=["webstatic-sea","hoyoverse.","hoyolab."],n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return!0;return!1}},{key:"getEnv",value:function(){var e=window.location.host;return e.indexOf("webstatic.mihoyo.com")>-1?"production":e.indexOf("webstatic-sea.")>-1?"production.sea":e.indexOf("-sea-test.")>-1?"test.sea":e.indexOf("-test.")>-1?"test":"production"}},{key:"getParamByName",value:function(e){var t=e.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),o=window.location.search,i=n.exec(o);if(i)return i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""}},{key:"getAccountid",value:function(){return r.default.get("account_id")||r.default.get("ltuid")}},{key:"getBh3SeaAccountid",value:function(){return r.default.get("bh3LoginUid")}},{key:"isHash",value:function(){return window.location.href.indexOf("#/")>-1}},{key:"getSessionInfo",value:function(){if(!this.needSessionInfo)return{sessionId:"",sessionStep:""};var e=r.default.get(this.sessionIdCookieKey),t=r.default.get(this.sessionStepCookieKey);return e||(t=0,e=this.uuid+"_"+(0,s.randomId)(),r.default.set(this.sessionIdCookieKey,e,{expires:this.sessionInfoExpires})),(t=Number(t))||(t=0),t+=1,r.default.set(this.sessionStepCookieKey,t,{expires:this.sessionInfoExpires}),{sessionId:e,sessionStep:t}}},{key:"getPageInfo",value:function(){var e=this.isHash()?window.location.hash.replace("#",""):window.location.pathname;return{app_id:this.app_id,page_url:this.pageurl||e,page_name:this.pagename||e,page_fullurl:window.location.href,utm_source:this.getParamByName("utm_source"),utm_medium:this.getParamByName("utm_medium"),utm_campaign:this.getParamByName("utm_campaign"),document_referrer:document.referrer,extra_info:this.pageExtrainfo}}},{key:"getUserInfo",value:function(){return{auth_key:this.getParamByName("authkey")||"",authkey_ver:this.getParamByName("authkey_ver"),game_biz:this.getParamByName("game_biz")||"",account_id:this.getAccountid()||"",bh3_sea_account_id:this.getBh3SeaAccountid(),game_uid:this.game_uid,game_region:this.game_region,uuid:this.uuid,device_id:this.device_id,extra_info:this.userExtrainfo}}},{key:"getEventInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.eventCategory,n=e.eventAction,i=e.eventLabel,a=e.eventValue,r=e.extraInfo,s=void 0===r?{}:r,u={eventCategory:t,eventAction:n,eventLabel:i,eventValue:a,timestamp:(new Date).getTime(),extra_info:o({},this.eventExtrainfo||{},s)};return u}},{key:"getAllParams",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.getSessionInfo(),o=n.sessionId,i=n.sessionStep,a={page_info:this.getPageInfo(),user_info:this.getUserInfo(),event_info:this.getEventInfo(t),type:this.type,data_belong:this.data_belong,mia_session_id:o,mia_session_step:i};return new Promise((function(t){e.bbsApp&&e.bbsApp.appVersion&&!e.device_id?e.bbsApp.getHTTPRequestHeaders().then((function(n){if(n&&n.data&&n.data["x-rpc-device_id"]){var o=n.data["x-rpc-device_id"];e.device_id=o,a.user_info.device_id=o}t(a)})):t(a)}))}},{key:"trackEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{var r={eventCategory:e,eventAction:t,eventLabel:n,eventValue:i,extraInfo:"[object Object]"===Object.prototype.toString.call(a)?a:{}};this.getAllParams(r).then((function(e){o.post(e)}))}catch(e){console.log(e)}}},{key:"trackPageview",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n=t.path,o=t.name;n&&(this.pageurl=n),o&&(this.pagename=o),this.getAllParams(this.pvParams).then((function(t){e.post(t)}))}catch(e){console.log(e)}}},{key:"updateUid",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.hasUpdateUid=!0;var n=t.uid,o=t.region;this.game_uid=n,this.game_region=o,this.eventList.forEach((function(t,n){n>10||setTimeout((function(){try{t.user_info.game_uid=e.game_uid,t.user_info.game_region=e.game_region,e.post(t)}catch(e){console.error(e)}}),200*n)})),this.eventList=[]}},{key:"post",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=this.apis[this.environment];if(!t)return;var n=new XMLHttpRequest;n.withCredentials=!0,n.open("POST",t,!0),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(e))}catch(e){console.error(e)}}}],[{key:"install",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new this;(0,s.initInstance)(n,o({Vue:e},t))}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new this;return(0,s.initInstance)(t,e)}}]),e}();t.default=d},function(e,t,n){var o;"undefined"!=typeof self&&self,e.exports=(o=n(0),function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=(o=n(1))&&o.__esModule?o:{default:o};function a(e){window.location.host.indexOf(".mihoyo.com")>-1?i.default.set("_MHYUUID",e,{domain:".mihoyo.com",path:"/",expires:365}):window.location.host.indexOf(".hoyolab.com")>-1?i.default.set("_MHYUUID",e,{domain:".hoyolab.com",path:"/",expires:365}):i.default.set("_MHYUUID",e,{path:"/",expires:365})}t.default={getVisitorId:function(){var e=this;return new Promise((function(t){t(e.getUuid())}))},getUuid:function(){var e=i.default.get("_MHYUUID");if(e)return a(e),e;for(var t=[],n=0;n<36;n++)t[n]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",a(e=t.join("")),e}}},function(e,t){e.exports=o}]).default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initInstance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.Vue,i=t.dataBelong,a=void 0===i?[]:i,r=t.appId,s=t.router,u=t.needUid,d=t.env,c=t.isSea,f=void 0!==c&&c,l=t.debug,p=void 0!==l&&l,v=t.pagename,h=t.device_id,g=void 0===h?"":h,m=t.pageExtrainfo,y=t.userExtrainfo,b=t.eventExtrainfo,_=t.type,w=void 0===_?"tool":_,x=t.autoTrackPageview,S=void 0===x||x,E=t.setMiaToVue,I=void 0===E||E,k=t.needSessionInfo,j=void 0!==k&&k,O=t.sessionInfoExpires,P=void 0===O?1/48:O,C=t.host,A=void 0===C?"":C,U=o||window.Vue;if(navigator&&navigator.userAgent.includes("miHoYoBBS/")){n(4);var M={test:"https://devapi-takumi.mihoyo.com/",production:"https://api-takumi.mihoyo.com/"},L=function(){var t=new XMLHttpRequest;t.withCredentials=!0;var n=M.production;["development","test","sandbox"].includes(d||e.environment)&&(n=M.test),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&(0!==JSON.parse(t.responseText).retcode&&U.prototype.$bbsApp.getCookieToken(!0).then((function(){U.prototype.$bbsApp.toLogin()})))},t.open("GET",n+"auth/api/getUserAccountInfoByCookieToken",!0),t.send()};window.addEventListener("ajaxReadyStateChange",(function(e){try{var t=e.detail;if(4===t.readyState&&200===t.status){var n=JSON.parse(t.responseText);if(!U){if(!window.Vue)return;U=window.Vue}[-100,10001].includes(n.retcode)&&U.prototype.$bbsApp&&L()}}catch(e){console.log(e)}}))}if(!r)throw console.error("请传入appId"),new Error("请传入appId");if(!Array.isArray(a))throw console.error("dataBelong的类型为数组"),e.data_belong="",new Error("dataBelong的类型为数组");return e.data_belong=a.join(","),d&&e.apis[d]&&(e.environment=d),(f||e.isHostSea)&&"production"===e.environment&&(e.environment="production.sea"),p&&(e.environment="test"),(f||e.isHostSea)&&"test"===e.environment&&(e.environment="test.sea"),U&&I&&(U.prototype.$mia=e),e.app_id=""+r,e.needUid=u||!1,e.pagename=v,e.pageExtrainfo=m,e.userExtrainfo=y,e.eventExtrainfo=b,e.type=w,e.device_id=g,e.needSessionInfo=j,e.sessionInfoExpires=P,e.host=A,e.bbsApp=U&&U.prototype.$bbsApp,S&&(U?s&&s.afterEach((function(t){var n=t||{},o=(n.meta||{}).miaPagename;e.pageurl=n.path,e.pagename=o||n.name||n.path,e.trackPageview()})):e.trackPageview()),e},t.randomId=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=[],n=Math.random,o=void 0;t[8]=t[13]=t[18]=t[23]=t[28]=t[33]=t[38]=t[43]=t[48]=t[53]=t[58]="-",t[14]="4";for(var i=0;i<64;i++)t[i]||(o=0|16*n(),t[i]=e[19===i?3&o|8:15&o]);return t.join("").toLowerCase()}},function(e,t,n){"use strict";!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),function(){function e(e){var t=new CustomEvent(e,{detail:this});window.dispatchEvent(t)}var t=window.XMLHttpRequest;window.XMLHttpRequest=function(){var n=new t;n.addEventListener("abort",(function(){e.call(this,"ajaxAbort")}),!1),n.addEventListener("error",(function(){e.call(this,"ajaxError")}),!1),n.addEventListener("load",(function(){e.call(this,"ajaxLoad")}),!1),n.addEventListener("loadstart",(function(){e.call(this,"ajaxLoadStart")}),!1),n.addEventListener("progress",(function(){e.call(this,"ajaxProgress")}),!1),n.addEventListener("timeout",(function(){e.call(this,"ajaxTimeout")}),!1),n.addEventListener("loadend",(function(){e.call(this,"ajaxLoadEnd")}),!1),n.addEventListener("readystatechange",(function(){e.call(this,"ajaxReadyStateChange")}),!1);var o=n.send;n.send=function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];o.apply(n,i),n.body=i[0],e.call(n,"ajaxSend")};var i=n.open;n.open=function(){for(var t=arguments.length,o=Array(t),a=0;a<t;a++)o[a]=arguments[a];i.apply(n,o),n.method=o[0],n.orignUrl=o[1],n.async=o[2],e.call(n,"ajaxOpen")};var a=n.setRequestHeader;return n.requestHeader={},n.setRequestHeader=function(e,t){n.requestHeader[e]=t,a.call(n,e,t)},n}}()}]).default}));